{% extends 'titi/base.html' %}

{% block content %}
<div class="container mt-5">
    <h2>Liste des Réservations</h2>
    
    <h5>Total des Tickets Réservés: {{ total_tickets }}</h5>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>N°</th>
                <th>Nom</th>
                <th>Numéro de Téléphone</th>
                <th>Email</th>
                <th>Quantité</th>
                <th class="no-print">Action</th> <!-- Ajout de la classe 'no-print' -->
            </tr>
        </thead>
        <tbody>
            {% for reservation in reservations %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ reservation.name }}</td>
                <td>{{ reservation.phone_number }}</td>
                <td>{{ reservation.email }}</td>
                <td>{{ reservation.ticket_quantity }}</td>
                <td class="no-print">
                    {% if not reservation.confirmed %}
                    <form action="{% url 'confirm_reservation' reservation.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-primary">Valider</button>
                    </form>
                    {% else %}
                    <button class="btn btn-success" disabled>Déjà confirmé</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Bouton d'impression centré en bas de la page -->
    <div class="d-flex justify-content-center mt-4">
        <button id="print-btn" class="btn btn-secondary" onclick="window.print()">Imprimer</button>
    </div>
</div>

<!-- Style pour masquer le bouton d'impression, le footer, et la colonne 'Action' lors de l'impression -->
<style>
@media print {
    #print-btn,
    .no-print,
    footer {
        display: none;
    }
}
</style>
{% endblock %}
